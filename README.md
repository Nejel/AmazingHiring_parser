# AmazingHiring_parser



#### Структура штуки:

Рабочая директория /workdir, в ней:

* db.sqlite -- база данных, в которой лежат имейлы, счётчик повторных нахождений имейла, ссылка на профиль в ЭмейзингХайринге
* Testlist.xsls -- исходный эксель. Изначально в нём в первом столбце лежит хедер и имейлики, которые надо проверить в ЭмейзингХайринге. В ходе работы программа добавляет во второй столбец ссылку на профиль человека в ЭмейзингХайринге.
* Логи, которые оставляет работа sqlite

Исполняемый файл AmazingHireParser.py. Его структура:

1. Без функции:

Определяем локальную рабочую директорию, коннектимся к БД (или создаем её), создаем табличку Counts, глобально задаем браузер через selenium.

2. OpenBrowser()

Используется глобальная переменная "браузер". Ждем ввода логина и пароля от ЭмейзингХайринг, открываем страницу логина в ЭмейзингХайринг. Нужно принять кукисы в баннере. Логинимся в ЭмейзингХайринг, запускаем следующую функцию.

3. ReadFolderAndFiles()

Тут пока что недописанный счетчик файлов в папке. Позже сделаю.

4. ExcelWorks(filename)

Открываем файл Тестлист.хлсх, лист щит1, считаем сколько строк в первом столбце. В цикле фор ходим по имейлам через i и записываем их в БД. После этого ищем файл в ЭмейзингХайринг, вызывая функцию Search. И после пишем ссылку на найденный профиль (если есть) обратно в Эксельку.

Если в БД уже есть имейл, который программа встречает в эксельке, то просто пишем It looks like we have alredy found (email).

5. Search(candicemail)

Функция вызывается по условию в ExcelWorks(filename), только в том случае, если мы ранее не работили с этим имейлом. По конструктору собирается ссылка на поиск (собака в имейле меняется на спецсимволы поиска "%40"). Далее в цикле try пробуем получить ссылку на профайл. Если профайлы есть -- условие пройдет. В таком случае вызываем запись в БД (PutToDB) и возвращаем в вышестоящую функцию ссылку на профайл (linktoprofile). Если в ЭмейзингХайринге ничего нет о человеке -- трай не пройдет (печатаем 'Nothing was found').

6. PutToDB(linktoprofile, candicemail)

Находим в БД имейл, с которым мы работали и подписываем к нему ссылку на профайл в ЭмейзингХайринге. Пока что присутсвует тупой баг -- ссылка пишется в следующую строку, а не в ту, которую надо. Получается что имейл, если он был найден, продублирован дважды. Пока что впадлу лезть в SQL, зафикшу это позже.
